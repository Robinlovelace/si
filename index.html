<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Develop spatial interaction models (SIMs).  SIMs predict the
    amount of interactions, for example number of trips per day, between
    geographic entities representing trip origins and destinations.  SIMs
    can be unconstrained, production-constrained, attraction-constrained
    and doubly-constrained (Wilson 1979) &lt;doi:10.1068/a030001&gt;.  The
    package contains functions for unconstrained and doubly-constrained
    SIMs.">
<title>Flexible Framework for Developing Spatial Interaction Models â€¢ si</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Flexible Framework for Developing Spatial Interaction Models">
<meta property="og:description" content="Develop spatial interaction models (SIMs).  SIMs predict the
    amount of interactions, for example number of trips per day, between
    geographic entities representing trip origins and destinations.  SIMs
    can be unconstrained, production-constrained, attraction-constrained
    and doubly-constrained (Wilson 1979) &lt;doi:10.1068/a030001&gt;.  The
    package contains functions for unconstrained and doubly-constrained
    SIMs.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">si</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/si.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/sims.html">An introduction to spatial interaction models: from first principles</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/robinlovelace/si/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p>The goal of {si} is to demonstrate Spatial Interaction models from first principles (see the <a href="https://robinlovelace.github.io/si/articles/sims.html"><code>sims</code> vignette</a> for a more detailed description of SIMs and implementation in R without using this package for reference). The package also contains reproducible code and documentation demonstrating how they work.</p>
<p>Spatial Interaction Models (SIMs) estimate movement between spatial entities. They have been central to transport modelling since the 1960s, with many refinements over the <a href="https://www.researchgate.net/publication/284345182_Forecasting_urban_travel_Past_present_and_future" class="external-link">decades</a>. There are four main <a href="https://doi.org/10.1016/j.jtrangeo.2015.12.008" class="external-link">types</a> of traditional SIM:</p>
<ul>
<li>Unconstrained</li>
<li>Production-constrained</li>
<li>Attraction-constrained</li>
<li>Doubly-constrained</li>
</ul>
<p>The focus of this package is currently on unconstrained and production-constrained SIMs.</p>
<!-- # Implementations in other languages -->
<div class="section level2">
<h2 id="si-basics">si basics<a class="anchor" aria-label="anchor" href="#si-basics"></a>
</h2>
<p>Install the package as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span> <span class="co"># if not already installed</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"robinlovelace/si"</span><span class="op">)</span></code></pre></div>
<p>Run a basic SIM as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/robinlovelace/si" class="external-link">si</a></span><span class="op">)</span>
<span class="va">od</span> <span class="op">=</span> <span class="fu"><a href="reference/si_to_od.html">si_to_od</a></span><span class="op">(</span>
  origins <span class="op">=</span> <span class="va">si_zones</span>,
  destinations <span class="op">=</span> <span class="va">si_zones</span>,
  max_dist <span class="op">=</span> <span class="fl">5000</span>
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="dv">2505</span> OD pairs remaining after removing those with a distance greater than <span class="dv">5000</span> meters<span class="op">:</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="dv">22</span>% of all possible OD pairs</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gravity_model</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">od</span>, <span class="va">beta</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">od</span><span class="op">[[</span><span class="st">"origin_all"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span> <span class="va">od</span><span class="op">[[</span><span class="st">"destination_all"</span><span class="op">]</span><span class="op">]</span> <span class="op">*</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">beta</span> <span class="op">*</span> <span class="va">od</span><span class="op">[[</span><span class="st">"distance_euclidean"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span>
<span class="op">}</span> 
<span class="va">od_res</span> <span class="op">=</span> <span class="fu"><a href="reference/si_model.html">si_model</a></span><span class="op">(</span><span class="va">od</span>, fun <span class="op">=</span> <span class="va">gravity_model</span>, beta <span class="op">=</span> <span class="fl">0.3</span>, var_p <span class="op">=</span> <span class="va">origin_all</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">od_res</span><span class="op">$</span><span class="va">distance_euclidean</span>, <span class="va">od_res</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-distance-1.png"></p>
<p>What just happened? As the example above shows, the package allows/encourages you to define and use your own functions to estimate the amount of interaction/movement between places. The resulting estimates of interaction, returned in the column <code>res</code> and plotted with distance in the graphic above, resulted from our choice of spatial interaction model inputs, allowing a wide range of alternative approaches to be implemented. This flexibility is a key aspect of the package, enabling small and easily modified functions to be implemented and tested.</p>
<p>The output <code><a href="reference/si_model.html">si_model()</a></code> is a geographic object which can be plotted as a map:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">od_res</span><span class="op">[</span><span class="st">"res"</span><span class="op">]</span>, logz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-map-1.png"></p>
<p>Perhaps the most important function in the package is therefore <code><a href="reference/si_to_od.html">si_to_od()</a></code>, which transforms geographic entities (typically zones but points and other geographic features could be used) into a data frame representing the full combination of origin-destination pairs that are less than <code>max_dist</code> meters apart. A common saying in data science is that 80% of the effort goes into the pre-processing stage. This is equally true for spatial interaction modelling as it is for other types of data intensive analysis/modelling work. So what does this function return?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">od</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a> [<span class="dv">1</span>] <span class="st">"O"</span>                         <span class="st">"D"</span>                        </span>
<span id="cb8-2"><a href="#cb8-2"></a> [<span class="dv">3</span>] <span class="st">"distance_euclidean"</span>        <span class="st">"origin_geo_name"</span>          </span>
<span id="cb8-3"><a href="#cb8-3"></a> [<span class="dv">5</span>] <span class="st">"origin_lad11cd"</span>            <span class="st">"origin_lad_name"</span>          </span>
<span id="cb8-4"><a href="#cb8-4"></a> [<span class="dv">7</span>] <span class="st">"origin_all"</span>                <span class="st">"origin_bicycle"</span>           </span>
<span id="cb8-5"><a href="#cb8-5"></a> [<span class="dv">9</span>] <span class="st">"origin_foot"</span>               <span class="st">"origin_car_driver"</span>        </span>
<span id="cb8-6"><a href="#cb8-6"></a>[<span class="dv">11</span>] <span class="st">"origin_car_passenger"</span>      <span class="st">"origin_motorbike"</span>         </span>
<span id="cb8-7"><a href="#cb8-7"></a>[<span class="dv">13</span>] <span class="st">"origin_train_tube"</span>         <span class="st">"origin_bus"</span>               </span>
<span id="cb8-8"><a href="#cb8-8"></a>[<span class="dv">15</span>] <span class="st">"origin_taxi_other"</span>         <span class="st">"destination_geo_name"</span>     </span>
<span id="cb8-9"><a href="#cb8-9"></a>[<span class="dv">17</span>] <span class="st">"destination_lad11cd"</span>       <span class="st">"destination_lad_name"</span>     </span>
<span id="cb8-10"><a href="#cb8-10"></a>[<span class="dv">19</span>] <span class="st">"destination_all"</span>           <span class="st">"destination_bicycle"</span>      </span>
<span id="cb8-11"><a href="#cb8-11"></a>[<span class="dv">21</span>] <span class="st">"destination_foot"</span>          <span class="st">"destination_car_driver"</span>   </span>
<span id="cb8-12"><a href="#cb8-12"></a>[<span class="dv">23</span>] <span class="st">"destination_car_passenger"</span> <span class="st">"destination_motorbike"</span>    </span>
<span id="cb8-13"><a href="#cb8-13"></a>[<span class="dv">25</span>] <span class="st">"destination_train_tube"</span>    <span class="st">"destination_bus"</span>          </span>
<span id="cb8-14"><a href="#cb8-14"></a>[<span class="dv">27</span>] <span class="st">"destination_taxi_other"</span>    <span class="st">"geometry"</span>                 </span></code></pre></div>
<p>As shown in the output above, the function allows you to use any variable in the origin or destination data in the function, with column names appended with <code>origin</code> and <code>destination</code>.</p>
<p>Note: support for OD datasets in which the origins and destinations are different objects is work in progress (see <a href="https://github.com/Robinlovelace/si/issues/3" class="external-link">#3</a>).</p>
</div>
<div class="section level2">
<h2 id="feedback">Feedback<a class="anchor" aria-label="anchor" href="#feedback"></a>
</h2>
<p>We would be interested to hear how the approach presented in this package compared with other implementations such as those presented in the links below. If anyone would like to try the approach or implement it in another language feel free to get in touch via the issue tracker.</p>
</div>
<div class="section level2">
<h2 id="alternative-approaches">Alternative approaches<a class="anchor" aria-label="anchor" href="#alternative-approaches"></a>
</h2>
<p>The {si} package is nascent. Anyone looking for more mature approaches could check the following:</p>
<ul>
<li><p>Reproducible <a href="https://rpubs.com/adam_dennett/257231" class="external-link">code</a> implementing SIMs in R by Adam Dennet, based on the outdated <code>sp</code> class system, and based on <a href="https://github.com/adamdennett/LondonSchoolsSIM/blob/main/Schools.Rmd" class="external-link"><code>sf</code> classes</a></p></li>
<li><p>The <a href="https://github.com/LukeCe/spflow" class="external-link"><code>spflow</code> R package</a> on CRAN</p></li>
<li><p>The <a href="https://spint.readthedocs.io/en/latest/" class="external-link"><code>spint</code> Python package</a></p></li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/robinlovelace/si/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/robinlovelace/si/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>AGPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing si</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robin Lovelace <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jakub Nowosad <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1057-3721" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/robinlovelace/si/actions" class="external-link"><img src="https://github.com/robinlovelace/si/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robin Lovelace, Jakub Nowosad.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
