<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="si">
<title>Tutorial: spatial interaction models with R • si</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: spatial interaction models with R">
<meta property="og:description" content="si">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">si</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/si.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sims.html">An introduction to spatial interaction models: from first principles</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/robinlovelace/si/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="si_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial: spatial interaction models with R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/robinlovelace/si/blob/HEAD/vignettes/si.Rmd" class="external-link"><code>vignettes/si.Rmd</code></a></small>
      <div class="d-none name"><code>si.Rmd</code></div>
    </div>

    
    
<p>Pre-requisites: you should have <a href="https://cran.r-project.org/" class="external-link">installed R</a> and a suitable editor such as <a href="https://www.rstudio.com/products/rstudio/download/preview/" class="external-link">RStudio</a> or <a href="https://github.com/REditorSupport/vscode-R" class="external-link">VSCode with R plugin</a>. See the package’s <a href="https://robinlovelace.github.io/si/">README</a> for instructions on installing the {si} package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/robinlovelace/si" class="external-link">si</a></span><span class="op">)</span></code></pre></div>
<p>This tutorial builds on <span class="citation">Dennett (2018)</span> (which in turn builds on <span class="citation">Dennett (2012)</span>’s pioneering <a href="https://github.com/adamdennett/SIModelling/blob/SIModelling-Edits/SimAus2.Rmd" class="external-link">reproducible</a> tutorial on SIMs with R). We start by importing open access data representing movement between zones in Australia (thanks to Adam Dennett for making the files accessible):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">u1</span> <span class="op">=</span> <span class="st">"https://www.dropbox.com/s/0fg80nzcxcsybii/GCCSA_2016_AUST_New.geojson?raw=1"</span>
<span class="va">aus</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="va">u1</span><span class="op">)</span>
<span class="va">u2</span> <span class="op">=</span> <span class="st">"https://www.dropbox.com/s/wi3zxlq5pff1yda/AusMig2011.csv?raw=1"</span>
<span class="va">od_migration_original</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">u2</span><span class="op">)</span></code></pre></div>
<p>Let’s take a quick look at these input datasets before modelling them with SIMs:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aus</span>
<span class="co">#&gt; Simple feature collection with 15 features and 6 fields</span>
<span class="co">#&gt; Geometry type: MULTIPOLYGON</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 112.9211 ymin: -43.74051 xmax: 159.1092 ymax: -9.142176</span>
<span class="co">#&gt; Geodetic CRS:  GDA94</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 7</span></span>
<span class="co">#&gt;    GCCSA_CODE GCC_CODE16 GCCSA_NAME              STATE_CODE STATE_NAME AREA_SQKM</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1RNSW      1RNSW      Rest of NSW             1          New South…   <span style="text-decoration: underline;">788</span>443.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1GSYD      1GSYD      Greater Sydney          1          New South…    <span style="text-decoration: underline;">12</span>368.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2GMEL      2GMEL      Greater Melbourne       2          Victoria       <span style="text-decoration: underline;">9</span>993.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2RVIC      2RVIC      Rest of Vic.            2          Victoria     <span style="text-decoration: underline;">217</span>503.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 3RQLD      3RQLD      Rest of Qld             3          Queensland  1<span style="text-decoration: underline;">714</span>330.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 3GBRI      3GBRI      Greater Brisbane        3          Queensland    <span style="text-decoration: underline;">15</span>842.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 4RSAU      4RSAU      Rest of SA              4          South Aus…   <span style="text-decoration: underline;">981</span>015.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 4GADE      4GADE      Greater Adelaide        4          South Aus…     <span style="text-decoration: underline;">3</span>260.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 5GPER      5GPER      Greater Perth           5          Western A…     <span style="text-decoration: underline;">6</span>416.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 5RWAU      5RWAU      Rest of WA              5          Western A…  2<span style="text-decoration: underline;">520</span>230.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 6GHOB      6GHOB      Greater Hobart          6          Tasmania       <span style="text-decoration: underline;">1</span>695.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 6RTAS      6RTAS      Rest of Tas.            6          Tasmania      <span style="text-decoration: underline;">66</span>323.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 7RNTE      7RNTE      Rest of NT              7          Northern …  1<span style="text-decoration: underline;">344</span>930.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 7GDAR      7GDAR      Greater Darwin          7          Northern …     <span style="text-decoration: underline;">3</span>164.</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 8ACTE      8ACTE      Australian Capital Ter… 8          Australia…     <span style="text-decoration: underline;">2</span>358.</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt;</span></span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">od_migration_original</span><span class="op">)</span>
<span class="co">#&gt; [1] 225  13</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">od_migration_original</span><span class="op">)</span>
<span class="co">#&gt;           Origin Orig_code       Destination Dest_code    Flow vi1_origpop</span>
<span class="co">#&gt; 1 Greater Sydney     1GSYD    Greater Sydney     1GSYD 3395015     4391673</span>
<span class="co">#&gt; 2 Greater Sydney     1GSYD       Rest of NSW     1RNSW   91031     4391673</span>
<span class="co">#&gt; 3 Greater Sydney     1GSYD Greater Melbourne     2GMEL   22601     4391673</span>
<span class="co">#&gt; 4 Greater Sydney     1GSYD       Rest of Vic     2RVIC    4416     4391673</span>
<span class="co">#&gt; 5 Greater Sydney     1GSYD  Greater Brisbane     3GBRI   22888     4391673</span>
<span class="co">#&gt; 6 Greater Sydney     1GSYD       Rest of Qld     3RQLD   27445     4391673</span>
<span class="co">#&gt;   wj1_destpop vi2_origunemp wj2_destunemp vi3_origmedinc wj3_destmedinc</span>
<span class="co">#&gt; 1     4391673          5.74          5.74         780.64         780.64</span>
<span class="co">#&gt; 2     2512952          5.74          6.12         780.64         509.97</span>
<span class="co">#&gt; 3     3999981          5.74          5.47         780.64         407.95</span>
<span class="co">#&gt; 4     1345717          5.74          5.17         780.64         506.58</span>
<span class="co">#&gt; 5     2065998          5.74          5.86         780.64         767.08</span>
<span class="co">#&gt; 6     2253723          5.74          6.22         780.64         446.48</span>
<span class="co">#&gt;   vi4_origpctrent wj4_destpctrent</span>
<span class="co">#&gt; 1           31.77           31.77</span>
<span class="co">#&gt; 2           31.77           27.20</span>
<span class="co">#&gt; 3           31.77           27.34</span>
<span class="co">#&gt; 4           31.77           24.08</span>
<span class="co">#&gt; 5           31.77           33.19</span>
<span class="co">#&gt; 6           31.77           32.57</span></code></pre></div>
<p>The results printed above show that:</p>
<ul>
<li><p><code>aus</code> represents the 15 regions of Australia, with columns containing zone identifiers (IDs), primarily <code>GCCSA_CODE</code>, and the area of each zone (<code>AREA_SQKM</code>).</p></li>
<li><p><code>od_migration_original</code> contains 225 rows of data representing the movement of people between the zones in <code>aus</code>. Note that 255 is 15 squared, meaning that this OD dataset contains the complete combination of migration flows, starting with zone <code>1GSYD</code> to <code>1GSYD</code>. These codes are present in the <code>GCCSA_CODE</code> column in the <code>aus</code> object. The first row of the OD dataset represents ‘intra-zonal’ migrations in Greater Sydney, presumably counting the number of people who move house from somewhere in the region to another home in the region. There are 13 columns in this dataset, the most important of which are <code>Orig_code</code>, <code>Dest_code</code>, and <code>Flow</code>.</p></li>
</ul>
<p>A useful convention with ‘long form’ OD datasets is for the first two columns to contain zone IDs that correspond to values in the first column of the zone dataset. The following code cleans the raw input datasets to get the data in this ideal form, and removes all variables that we do not currently need:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># todo</span></code></pre></div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-dennett_estimating_2012">
<p>Dennett, Adam. 2012. “Estimating Flows Between Geographical Locations:’Get Me Started in’spatial Interaction Modelling.” <em>UCL Working Papers Series</em> 44 (0): 024. <a href="http://www.bartlett.ucl.ac.uk/casa/publications/working-paper-181" class="external-link">http://www.bartlett.ucl.ac.uk/casa/publications/working-paper-181</a>.</p>
</div>
<div id="ref-dennett_modelling_2018">
<p>———. 2018. “Modelling Population Flows Using Spatial Interaction Models.” <em>Australian Population Studies</em> 2 (2): 33–58. <a href="https://doi.org/10.37970/aps.v2i2.38" class="external-link">https://doi.org/10.37970/aps.v2i2.38</a>.</p>
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robin Lovelace, Jakub Nowosad.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
